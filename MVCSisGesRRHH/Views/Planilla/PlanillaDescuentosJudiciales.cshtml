@using System.Configuration
@using MVCSisGesRRHH.Models;

@{
    ViewBag.Title = "PLANILLAS  ->  DESCUENTOS JUDICIALES";
}
@section SubTitulo { <h3>@ViewBag.Title</h3> }
<style>
    .row {
        margin-right: 0px;
        margin-left: 0px;
    }

    .contentWrap {
        position: relative;
        width: 98%;
        margin: 0 auto;
        padding: 0;
    }

    .tdDetalle {
        /*font-weight: bold;*/
        font-size: 11px;
        border-style: solid;
        border-width: 1px;
        padding: 5px;
        border-color: #ccc;
    }

    .tdDetalleNegrita {
        font-size: 11px;
        font-weight: bold;
        border-style: solid;
        border-width: 1px;
        padding: 5px;
        border-color: #ccc;
        background-color: #F5F5F5;
    }

    legend {
        display: block;
        width: 100%;
        padding: 0;
        margin-bottom: 10px;
        font-size: 18px;
        line-height: inherit;
        color: #333;
        border: 0;
        border-bottom: 1px solid #e5e5e5;
    }

    .k-grid .k-state-selected {
        background-color: #aaffff !important;
        color: #000000;
    }

    .k-grid .k-alt.k-state-selected {
        background-color: #aaffff !important;
        color: #000000;
    }

    .k-grid-header th.k-header {
        vertical-align: bottom;
        text-align: center;
    }

    /*tr.k-footer-template td {
        font-size: 14px;
        background-color: RGB(255, 221, 221) !important;
        border-width: 1px 0px;
        border-color: RGB(255, 122, 122);
        border-style: solid;
        padding: 3px 5px 3px 5px;
        text-align: right;
    }

    tr.k-group-footer td {
        text-align: right;
    }*/

    .console {
        background-color: transparent;
        color: #333;
        font: 11px Consolas, Monaco, "Bitstream Vera Sans Mono", "Courier New", Courier, monospace;
        margin: 0;
        overflow-x: hidden;
        text-align: left;
        height: 200px;
        border: 1px solid rgba(20,53,80,0.1);
        background-color: #ffffff;
        text-indent: 0;
    }

        .console div {
            background-position: 6px -95px;
            border-bottom: 1px solid #DDD;
            padding: 5px 10px;
            height: 2em;
            line-height: 2em;
            vertical-align: middle;
        }

    input, label, .k-input {
        font-size: 11px;
    }
</style>
<!-- Main content -->

<section class="content">
    <div class="panel-group" id="accordion">
        <!--DESCUENTOS JUDICIALES -->
        <div class="panel panel-default">
            <div id="pTrabajadores" class="panel panel-default">
                <div class="panel-heading">
                    <a data-toggle="collapse" href="#collapseTrabajadores">
                        <span class="indicador glyphicon glyphicon-chevron-up" aria-hidden="true"></span>  TRABAJADORES
                    </a>
                </div>
                <div id="collapseTrabajadores" class="panel-collapse collapse in">
                    <div class="panel-body" id="divListarTrabajadores">
                        <div class="row">
                            <div id="divTotalTrabajadores" class="col-md-2">
                                <h5><label>Total de Registros: &nbsp;</label><label id="lblTotal" class="label label-info"></label></h5>
                            </div>
                            <div class="col-md-10" style="text-align: right; margin-bottom: 10px">
                                <button id="btnAgregarConceptoTrabajadores" type="button" class="btn btn-primary btn-sm" onclick="controlador.abrirModalDescuentoJudicial(0)">
                                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Agregar
                                </button>
                                @*<button id="btnGenerarPlanillaTrabajadores" type="submit" class="btn btn-primary btn-sm" onclick="controlador.abrirModalGenerarPlanillaJudicial()" title="Cargar Retenciones Judiciales a la Planilla del mes">
                                    <span class="glyphicon glyphicon-copy" aria-hidden="true"></span> Generar
                                </button>*@

                            </div>

                        </div>
                        <div class="row">
                            <div id="divGridDescuentoJudicialTrabajadores"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="panel-heading">
                <a data-toggle="collapse" href="#collapseDescuentoJudicial">
                    <span class="indicador glyphicon glyphicon-chevron-up" aria-hidden="true"></span> RETENCIONES JUDICIALES
                </a>
            </div>
            <div id="collapseDescuentoJudicial" class="panel-collapse collapse in">
                <div class="panel-body">
                    <div class="row form-horizontal">
                        @*<form id="frmBandejaDescuentoJudicial" name="frmBandejaDescuentoJudicial" novalidate="" onsubmit="controlador.CargarGrillaConceptoTrabajador(event)">*@
                        <form id="frmBandejaDescuentoJudicial" name="frmBandejaDescuentoJudicial" novalidate="" onsubmit="controlador.buscar(event)">
                            
                            <div class="col-md-12">
                                    <div class="col-md-3">
                                        <label for="ddlAnio_busqueda" class="control-label">Año </label>
                                        <select id="ddlAnio_busqueda" name="ddlAnio_busqueda" class="form-control input-sm" style="width: 100%;">
                                            <option value="">-- Todos --</option>
                                        </select>

                                    </div>
                                    <div class="col-md-3">
                                        <label for="ddlMes_busqueda" class="control-label">Mes</label>
                                        <div>
                                            <select id="ddlMes_busqueda" name="ddlMes_busqueda" class="form-control input-sm" style="width: 100%;">
                                                <option value="" selected>-- Todos --</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="col-md-3">
                                        <label for="ddlPlanillaAperturada_busqueda" class="control-label">Planilla Aperturada</label>
                                        <select id="ddlPlanillaAperturada_busqueda" name="ddlPlanillaAperturada_busqueda" class="form-control input-sm" style="width: 100%;">
                                            <option value="" selected>-- Seleccione --</option>
                                        </select>
                                    </div>

                                    <div class="col-md-3" style="text-align: center;">
                                        <label for="botones" class="control-label">&nbsp;</label>
                                        <div>                                            
                                            <button id="btnBuscarPlanillaAperturada" type="submit" class="btn btn-primary btn-sm">
                                                <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Buscar
                                            </button>                                            
                                            <button type="reset" class="btn btn-default btn-sm">
                                                <span class="glyphicon glyphicon-eject" aria-hidden="true"></span> Limpiar
                                            </button>                                           
                                            <button id="btnGenerarPlanillaTrabajadores" type="submit" class="btn btn-primary btn-sm" onclick="controlador.GenerarPlanillaJudicial()">
                                                <span class="glyphicon glyphicon-copy" aria-hidden="true"></span> Generar
                                            </button>
                                        </div>
                                    </div>

                                </div>
                            </form>
                    </div>
                </div>
            </div>


        </div>

        <div id="pResultado" class="panel panel-default">
            <div class="panel-heading">
                <a data-toggle="collapse" href="#collapseReclamo">
                    <span class="indicador glyphicon glyphicon-chevron-up" aria-hidden="true"></span>  RESULTADO DE LA B&Uacute;SQUEDA
                </a>
            </div>
            <div id="collapseReclamo" class="panel-collapse collapse in">
                <div class="panel-body" id="divListarAplicacion">
                    <div class="row">
                        <div id="divTotal" class="col-md-2">
                            <h5><label>Total de Registros: &nbsp;</label><label id="lblTotal" class="label label-info"></label></h5>
                        </div>
                        @*<div class="col-md-10" style="text-align: right; margin-bottom: 10px">
                            <button id="btnAgregarConcepto" type="button" class="btn btn-primary btn-sm" onclick="controlador.abrirModalDescuentoJudicial(0)">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Agregar
                            </button>                            
                        </div>*@

                    </div>
                    <div class="row">
                        <div id="divGridDescuentoJudicial"></div>
                        <script type="text/x-kendo-template" id="template">
                            <div class="tabstrip">
                                <ul>
                                    <li class="k-state-active">
                                        @*<a data-toggle="tabE" href="#tab1E">INGRESOS</a>*@
                                        BENEFICIARIOS
                                    </li>                                    
                                </ul>
                                <div>
                                    <div class="divGridGridDescuentoJudicialBeneficiarios"></div>
                                </div>                                
                            </div>
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>

    @*<input id="hdIdCodTrabajador" name="hdIdCodTrabajadorBand" type="hidden" value="@VariablesWeb.oT_Genm_Usuario.iCodTrabajador" />
        <input id="hdIdBasePerfilPuesto" name="hdIdBasePerfilPuesto" type="hidden" value="" />*@

    <!-- The Modal -->
    <div id="divModalDescuentoJudicial" style="display:none; font-size: 11px">
        <form id="frmRegistroJudicialTrabajador" name="frmRegistroJudicialTrabajador" novalidate="" onsubmit="controlador.agregarDescuentoJudicial(event)">
            <input id="hdIdJudicial" name="hdIdJudicial" type="hidden" value="0" />
            <div class="panel-heading">
                <div class="row">
                    <div class="col-md-12">

                        <div class="col-md-4">
                            <label for="ddlAnio_planilla" class="control-label text-right">Año</label>
                            <select id="ddlAnio_planilla" name="ddlAnio_planilla" class="form-control" style="width: 100%;" required="required" validationmessage="requerido">
                                <option value="">-- Seleccione --</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="ddlMes_planilla" class="control-label">Mes</label>
                            <div>
                                <select id="ddlMes_planilla" name="ddlMes_planilla" class="form-control input-sm" style="width: 100%;" required="required" validationmessage="requerido">
                                    <option value="" selected>-- Todos --</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="ddlPlanillaAperturada" class="control-label">Planilla Aperturada</label>
                            <select id="ddlPlanillaAperturada" name="ddlPlanillaAperturada" class="form-control input-sm" style="width: 100%;" required="required" validationmessage="requerido">
                                <option value="" selected>-- Seleccione --</option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>
            <div class="panel panel-default">
                
               
                <div class="panel-heading">
                    <div class="row">
                        @*<div class="form-group col-md-4">
                        <label for="ddlPersonaTipoDocumento" class="control-label">Tipo de documento*</label>
                        <select id="ddlPersonaTipoDocumento" name="ddlPersonaTipoDocumento" class="form-control input-sm" style="width: 100%;" required="required" validationmessage="requerido" onchange="controlador.PersonaCambiar()">
                            <option value="">-- Seleccione --</option>
                        </select>
                        </div>*@
                        <div class="form-group col-md-4">
                            <label for="txtNumeroDocumentoTrabajador" class="control-label">Número de documento*</label>
                            <div class="input-group">
                                <input id="txtNumeroDocumentoTrabajador" name="txtNumeroDocumentoTrabajador" type="text" class="form-control input-sm" required="required" maxlength="8" validationmessage="requerido" onkeypress="SoloNumeros(event);" />
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-sm" id="btnBuscarP" onclick="BuscarTrabajadorJudicial();" title="Clic aquí para consultar datos del trabajador" style="height: 18px;">
                                        <i class="glyphicon glyphicon-search"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                        <div class="form-group col-md-8">
                            <label for="txtNombreTrabajador" class="col-md-4 control-label text-right">Trabajador</label>
                            <input type="text" id="txtNombreTrabajador" name="txtNombreTrabajador" class="form-control input-sm " required="required" validationmessage="requerido" readonly />
                        </div>

                    </div>
                </div>
                <div class="panel-body">
                    @*<div class="row">
                        <div class="col-md-8">
                            <label for="txtMontoRetencionTotal" class="col-md-4 control-label text-right">Monto Retención Total</label>
                            <div class="col-md-4">
                                <input type="number" id="txtMontoRetencionTotal" name="txtMontoRetencionTotal" class="form-control input-sm " validationmessage="requerido" />
                            </div>
                        </div>
                    </div>*@

                    <div class="row">
                        <br />
                        <div class="panel panel-default">
                            <div class="panel-heading">REGISTRO DE BENEFICIARIOS</div>
                            <div class="panel-body">

                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label for="txtNumeroDocumentoBeneficiario" class="control-label">Número documento Beneficiario *</label>
                                        <div class="input-group">
                                            <input id="txtNumeroDocumentoBeneficiario" name="txtNumeroDocumentoBeneficiario" type="text" class="form-control input-sm" maxlength="8" validationmessage="requerido" onkeypress="SoloNumeros(event);" />
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" id="btnBuscarP" onclick="BuscarBeneficiario();" title="Clic aquí para consultar datos del beneficiario" style="height: 18px;">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-8">
                                        <label for="txtNombreBeneficiario" class="col-md-4 control-label text-left">Beneficiario</label>
                                        <input type="text" id="txtNombreBeneficiario" name="txtNombreBeneficiario" class="form-control input-sm " validationmessage="requerido" />
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label for="ddlBancos" class="control-label">Banco *</label>
                                        <select id="ddlBancos" name="ddlBancos" class="form-control input-sm" style="width: 100%;" validationmessage="requerido">
                                            <option value="">-- Seleccione --</option>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-4">
                                        <label for="txtNumeroCuenta" class="control-label">Nùmero de Cuenta</label>
                                        <input type="text" id="txtNumeroCuenta" name="txtNumeroCuenta" class="form-control input-sm " maxlength="25" validationmessage="requerido" readonly />

                                    </div>

                                    <div class="form-group col-md-4">
                                        <label for="ddlTipoRetencion" class="control-label">Tipo de Retención *</label>
                                        <select id="ddlTipoRetencion" name="ddlTipoRetencion" class="form-control input-sm" style="width: 100%;" validationmessage="requerido">
                                            <option value="">-- Seleccione --</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label for="ddlFormaPago" class="control-label">Forma de Pago *</label>
                                        <select id="ddlFormaPago" name="ddlFormaPago" class="form-control input-sm" style="width: 100%;" validationmessage="requerido">
                                            <option value="">-- Seleccione --</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-4" id="divPorcentaje">
                                        <label for="txtValorPorcentaje" class="control-label text-left">Porcentaje Retención (%)</label>
                                        <input type="number" id="txtValorPorcentaje" name="txtValorPorcentaje" class="form-control input-sm " min="1" max="99" validationmessage="requerido hasta 99%" readonly />

                                    </div>

                                    <div class="form-group col-md-4" id="divMonto">
                                        <label for="txtImporteFijo" class="control-label text-left">Importe Retención</label>
                                        <input type="number" id="txtImporteFijo" name="txtImporteFijo" class="form-control input-sm " min="1" max="99999" validationmessage="requerido hasta 99999" readonly />

                                    </div>
                                    @*<div class="form-group col-md-8">
                                    <label for="txtObservacion" class="control-label text-left">Observación</label>
                                    <input type="text" id="txtObservacion" name="txtObservacion" class="form-control input-sm " />

                                    </div>*@
                                </div>
                                <div class="col-md-12" style="text-align: right; margin-bottom: 10px">
                                    <button id="btnAgregarBeneficiario" type="button" class="btn btn-primary btn-sm" onclick="controlador.AgregarBeneficiarioTemporal(event)">
                                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Agregar Beneficiario
                                    </button>
                                    <button id="btnLimpiarBeneficiario" type="button" class="btn btn-default btn-sm" onclick="controlador.LimpiarBeneficiarios()">
                                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> Limpiar
                                    </button>

                                </div>

                            </div>
                            <div class="panel-body">

                                <div class="row">
                                    <div id="divGridBeneficiarios"></div>
                                </div>
                                <div class="row">
                                    <div id="divTotalBeneficiario" class="col-md-2">
                                        <h5><label>N° Beneficiarios: &nbsp;</label><label id="lblNroBeneficiario" class="label label-info"></label></h5>

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                
                <div class="modal-footer">
                    <button id="btnGuardarAdmin" type="submit" class="btn btn-primary btn-sm">
                        <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Guardar
                    </button>
                    <button type="button" class="btn btn-default btn-sm" onclick="controlador.cerrarModalDescuentoJudicial()">
                        <span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span> Cancelar
                    </button>

                </div>
            
            </div>
        </form>
    </div>
    <div id="divModalGenerarPlanilla" style="display:none;">
        <div class="panel panel-default">
            <div class="panel-body">
                <h4 id="hCargar">¿Está seguro de realizar la CARGA DE RETENCIONES JUDICIALES ?</h4>
                <p id="pCargar"></p>
                <div class="row">
                    <div class="col-md-6">
                        <label for="ddlPlanillaAperturada_carga" class="control-label">Planilla del Mes</label>
                        <select id="ddlPlanillaAperturada_carga" name="ddlPlanillaAperturada_carga" class="form-control input-sm" required="required" style="width: 100%;">
                            <option value="" selected>-- Seleccione --</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="panel-footer" style="text-align:right;">
                <button type="button" class="btn btn-default btn-sm" onclick="controlador.cerrarModalGenerarPlanillaJudicial()">
                    <span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span> Cancelar
                </button>
                <button id="btnCargar" type="button" class="btn btn-primary btn-sm" onclick="controlador.cargarPlanillaJudicial()">
                    <span class=" glyphicon glyphicon-save" aria-hidden="true">
                    </span> Confirmar
                </button>
            </div>
        </div>
    </div>
    <div id="divModalEliminacion" style="display:none;">
        <div class="panel panel-default">
            <div class="panel-body">
                <h4 id="hEliminacion">¿Está seguro de eliminar Descuento Judicial seleccionado?</h4>
                <p id="pEliminacion"></p>
                <div class="row">
                    <h4><label>Trabajador : &nbsp;</label><label id="lblTrabajador" class="label label-default"></label></h4>
                </div>
            </div>
            <div class="panel-footer" style="text-align:right;">
                <button type="button" class="btn btn-default btn-sm" onclick="controlador.cerrarModalEliminacion()">
                    <span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span> Cancelar
                </button>
                <button id="btnEliminar" type="button" class="btn btn-primary btn-sm" onclick="controlador.eliminar()">
                    <span class="glyphicon glyphicon-save" aria-hidden="true"></span> Confirmar
                </button>
            </div>
        </div>
    </div>

    <div id="divModalDescuentoJudicialTrabajador" style="display:none; font-size: 11px">
        <form id="frmRegistroJudicial" name="frmRegistroJudicial" novalidate="" onsubmit="controlador.agregarDescuentoJudicialTrabajador(event)">
            <input id="hdIdJudicialTrabajador" name="hdIdJudicialTrabajador" type="hidden" value="0" />
            @*<div class="panel-heading">
                <div class="row">
                    <div class="col-md-12">

                        <div class="col-md-4">
                            <label for="ddlAnio_planilla" class="control-label text-right">Año</label>
                            <select id="ddlAnio_planilla" name="ddlAnio_planilla" class="form-control" style="width: 100%;" required="required" validationmessage="requerido">
                                <option value="">-- Seleccione --</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="ddlMes_planilla" class="control-label">Mes</label>
                            <div>
                                <select id="ddlMes_planilla" name="ddlMes_planilla" class="form-control input-sm" style="width: 100%;" required="required" validationmessage="requerido">
                                    <option value="" selected>-- Todos --</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="ddlPlanillaAperturada" class="control-label">Planilla Aperturada</label>
                            <select id="ddlPlanillaAperturada" name="ddlPlanillaAperturada" class="form-control input-sm" style="width: 100%;" required="required" validationmessage="requerido">
                                <option value="" selected>-- Seleccione --</option>
                            </select>
                        </div>

                    </div>
                </div>
            </div>*@
            <div class="panel panel-default">


                <div class="panel-heading">
                    <div class="row">
                        @*<div class="form-group col-md-4">
                        <label for="ddlPersonaTipoDocumento" class="control-label">Tipo de documento*</label>
                        <select id="ddlPersonaTipoDocumento" name="ddlPersonaTipoDocumento" class="form-control input-sm" style="width: 100%;" required="required" validationmessage="requerido" onchange="controlador.PersonaCambiar()">
                            <option value="">-- Seleccione --</option>
                        </select>
                        </div>*@
                        <div class="form-group col-md-4">
                            <label for="txtNumeroDocumentoTrabajadorJudicial" class="control-label">Número de documento*</label>
                            <div class="input-group">
                                <input id="txtNumeroDocumentoTrabajadorJudicial" name="txtNumeroDocumentoTrabajadorJudicial" type="text" class="form-control input-sm" required="required" maxlength="8" validationmessage="requerido" onkeypress="SoloNumeros(event);" />
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default btn-sm" id="btnBuscarPJudicial" onclick="BuscarTrabajador();" title="Clic aquí para consultar datos del trabajador" style="height: 18px;">
                                        <i class="glyphicon glyphicon-search"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                        <div class="form-group col-md-8">
                            <label for="txtNombreTrabajadorJudicial" class="col-md-4 control-label text-right">Trabajador</label>
                            <input type="text" id="txtNombreTrabajadorJudicial" name="txtNombreTrabajadorJudicial" class="form-control input-sm " required="required" validationmessage="requerido" readonly />
                        </div>

                    </div>
                </div>
                <div class="panel-body">
                    @*<div class="row">
                        <div class="col-md-8">
                            <label for="txtMontoRetencionTotal" class="col-md-4 control-label text-right">Monto Retención Total</label>
                            <div class="col-md-4">
                                <input type="number" id="txtMontoRetencionTotal" name="txtMontoRetencionTotal" class="form-control input-sm " validationmessage="requerido" />
                            </div>
                        </div>
                    </div>*@

                    <div class="row">
                        <br />
                        <div class="panel panel-default">
                            <div class="panel-heading">REGISTRO DE BENEFICIARIOS</div>
                            <div class="panel-body">

                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label for="txtNumeroDocumentoBeneficiarioJudicial" class="control-label">Número documento Beneficiario *</label>
                                        <div class="input-group">
                                            <input id="txtNumeroDocumentoBeneficiarioJudicial" name="txtNumeroDocumentoBeneficiarioJudicial" type="text" class="form-control input-sm" maxlength="8" validationmessage="requerido" onkeypress="SoloNumeros(event);" />
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn-default btn-sm" id="btnBuscarPJudicial" onclick="BuscarBeneficiarioJudicial();" title="Clic aquí para consultar datos del beneficiario" style="height: 18px;">
                                                    <i class="glyphicon glyphicon-search"></i>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                    <div class="form-group col-md-8">
                                        <label for="    " class="col-md-4 control-label text-left">Beneficiario</label>
                                        <input type="text" id="txtNombreBeneficiarioJudicial" name="txtNombreBeneficiarioJudicial" class="form-control input-sm " validationmessage="requerido" />
                                    </div>

                                </div>
                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label for="ddlBancosJudicial" class="control-label">Banco *</label>
                                        <select id="ddlBancosJudicial" name="ddlBancosJudicial" class="form-control input-sm" style="width: 100%;" validationmessage="requerido">
                                            <option value="">-- Seleccione --</option>
                                        </select>
                                    </div>

                                    <div class="form-group col-md-4">
                                        <label for="txtNumeroCuentaJudicial" class="control-label">Nùmero de Cuenta</label>
                                        <input type="text" id="txtNumeroCuentaJudicial" name="txtNumeroCuentaJudicial" class="form-control input-sm " maxlength="25" validationmessage="requerido" readonly />

                                    </div>

                                    <div class="form-group col-md-4">
                                        <label for="ddlTipoRetencionJudicial" class="control-label">Tipo de Retención *</label>
                                        <select id="ddlTipoRetencionJudicial" name="ddlTipoRetencionJudicial" class="form-control input-sm" style="width: 100%;" validationmessage="requerido">
                                            <option value="">-- Seleccione --</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="form-group col-md-4">
                                        <label for="ddlFormaPagoJudicial" class="control-label">Forma de Pago *</label>
                                        <select id="ddlFormaPagoJudicial" name="ddlFormaPagoJudicial" class="form-control input-sm" style="width: 100%;" validationmessage="requerido">
                                            <option value="">-- Seleccione --</option>
                                        </select>
                                    </div>
                                    <div class="form-group col-md-4" id="divPorcentajeJudicial">
                                        <label for="txtValorPorcentajeJudicial" class="control-label text-left">Porcentaje Retención (%)</label>
                                        <input type="number" id="txtValorPorcentajeJudicial" name="txtValorPorcentajeJudicial" class="form-control input-sm " min="1" max="99" validationmessage="requerido hasta 99%" readonly />

                                    </div>

                                    <div class="form-group col-md-4" id="divMontoJudicial">
                                        <label for="txtImporteFijoJudicial" class="control-label text-left">Importe Retención</label>
                                        <input type="number" id="txtImporteFijoJudicial" name="txtImporteFijoJudicial" class="form-control input-sm " min="1" max="99999" validationmessage="requerido hasta 99999" readonly />

                                    </div>
                                    @*<div class="form-group col-md-8">
                                    <label for="txtObservacion" class="control-label text-left">Observación</label>
                                    <input type="text" id="txtObservacion" name="txtObservacion" class="form-control input-sm " />

                                    </div>*@
                                </div>
                                <div class="col-md-12" style="text-align: right; margin-bottom: 10px">
                                    <button id="btnAgregarBeneficiarioJudicial" type="button" class="btn btn-primary btn-sm" onclick="controlador.AgregarBeneficiarioJudicialTemporal(event)">
                                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Agregar Beneficiario
                                    </button>
                                    <button id="btnLimpiarBeneficiarioJudicial" type="button" class="btn btn-default btn-sm" onclick="controlador.LimpiarBeneficiariosTrabajadores()">
                                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> Limpiar
                                    </button>

                                </div>

                            </div>
                            <div class="panel-body">

                                <div class="row">
                                    <div id="divGridBeneficiariosJudicial"></div>
                                </div>
                                <div class="row">
                                    <div id="divTotalBeneficiarioJudicial" class="col-md-2">
                                        <h5><label>N° Beneficiarios: &nbsp;</label><label id="lblNroBeneficiarioJudicial" class="label label-info"></label></h5>

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <div class="modal-footer">
                    <button id="btnGuardarAdminJudicial" type="submit" class="btn btn-primary btn-sm">
                        <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Guardar
                    </button>
                    <button type="button" class="btn btn-default btn-sm" onclick="controlador.cerrarModalDescuentoJudicialTrabajadores()">
                        <span class="glyphicon glyphicon-ban-circle" aria-hidden="true"></span> Cancelar
                    </button>

                </div>

            </div>
        </form>
    </div>

    <input id="hdnUid" name="hdnUid" type="hidden" />
    
    <input id="hdIdJudicialDetalle" name="hdIdJudicialDetalle" type="hidden" value="0" />
    <input id="hdIdTrabajador" name="hdIdTrabajador" type="hidden" value="0" />
    <input id="hdIdPlanilla" name="hdIdPlanilla" type="hidden" value="" />
    <input id="hdIdTipoPlanilla" name="hdIdTipoPlanilla" type="hidden" value="" />
    <input id="hdTotalRetencion" name="hdIdTipoPlanilla" type="hidden" value="0" />
    <input id="hdCambioDetalle" name="hdCambioDetalle" type="hidden" value="0" />
    <input id="hdiCodDetPlanilla" name="hdiCodDetPlanilla" type="hidden" value="" />

    <input id="hdIdJudicialDetalleJudicial" name="hdIdJudicialDetalleJudicial" type="hidden" value="0" />
    <input id="hdIdTrabajadorJudicial" name="hdIdTrabajadorJudicial" type="hidden" value="0" />    
    <input id="hdTotalRetencionJudicial" name="hdTotalRetencionJudicial" type="hidden" value="0" />
    <input id="hdCambioDetalleJudicial" name="hdCambioDetalleJudicial" type="hidden" value="0" />
    
</section>
<!-- /.content -->
@section Scripts {
    <script src="~/Scripts/kendo/2018.1.221/jszip.min.js"></script>
    <script src="~/Scripts/App/Intranet/DescuentoJudicial.js"></script>
    <script src="~/Scripts/source/modBase.js"></script>

    <script type="text/javascript">
        var controlador;

        $(document).ready(function () {
            controlador = new DescuentoJudicialJS();
            controlador.inicializarBandejaDescuentoJudicial();

        });

        function BuscarTrabajadorJudicial() { //campo, campoId
            var tipo = "Solic";
            var TIPO_DOC_DNI = '01';
            var TIPO_DOC_CE = '02';
            var campo = document.getElementById("txtNumeroDocumentoTrabajador");
            //var tipoDoc = $("#ddlPersonaTipoDocumento").data("kendoDropDownList").value();

            var urlBuscarPersona = URL + 'Persona/Buscar';

            debugger;

            if (campo.value.trim().length < 8) {
                controladorApp.notificarMensajeDeAlerta("Ingrese un número de documento válido");
                return false;
            }
            //if (tipoDoc == '') {
            //    controladorApp.notificarMensajeDeAlerta("Seleccione el tipo de documento");
            //    return false;
            //}

            if (campo.value.trim().length == 8) {
                // PRIMERO BUSCAMOS SI EL SOLICITANTE EXISTE EN NUESTRA BD
                var data_param = {};
                //data_param.TipoDeDocumento = $("#ddlPersonaTipoDeDocumento").data("kendoDropDownList").value();
                data_param.TipoDeDocumento = 1;
                data_param.IdDependencia = 0;
                data_param.Estado = 1;
                data_param.IdEmpleado = 0
                data_param.NroDocumento = $("#txtNumeroDocumentoTrabajador").val();

                $.ajax({
                    url: controladorApp.obtenerRutaBase() + 'Empleado/ListarEmpleados',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8',
                    processData: true,
                    cache: false,
                    data: data_param,
                    success: function (res) {
                        if (res != null && res.length > 0) {
                            var vEmpleado = res[0].Paterno + ' ' + res[0].Materno + ' ' + res[0].Nombre;
                            $("#hdIdTrabajador").val(res[0].IdEmpleado);
                            $("#txtNombreTrabajador").val(vEmpleado);
                        }
                        else {
                            debugger;
                            // LimpiarModalRegistroPersona();
                            $("#hdIdTrabajador").val('');
                            $("#txtNombreTrabajador").val('');
                            controladorApp.notificarMensajeDeAlerta('No existe el número de documento, consultar con el administrador');
                        }
                    },
                    error: function (res) {
                        debugger;
                    }
                });

            }

            else {
                controladorApp.notificarMensajeDeAlerta("Ingrese un número de documento válido");
                return false;
            }

        }

        function BuscarTrabajador() { //campo, campoId
            var tipo = "Solic";
            var TIPO_DOC_DNI = '01';
            var TIPO_DOC_CE = '02';
            var campo = document.getElementById("txtNumeroDocumentoTrabajadorJudicial");
            //var tipoDoc = $("#ddlPersonaTipoDocumento").data("kendoDropDownList").value();

            var urlBuscarPersona = URL + 'Persona/Buscar';

            debugger;

            if (campo.value.trim().length < 8) {
                controladorApp.notificarMensajeDeAlerta("Ingrese un número de documento válido");
                return false;
            }
            //if (tipoDoc == '') {
            //    controladorApp.notificarMensajeDeAlerta("Seleccione el tipo de documento");
            //    return false;
            //}

            if (campo.value.trim().length == 8) {
                // PRIMERO BUSCAMOS SI EL SOLICITANTE EXISTE EN NUESTRA BD
                var data_param = {};
                //data_param.TipoDeDocumento = $("#ddlPersonaTipoDeDocumento").data("kendoDropDownList").value();
                data_param.TipoDeDocumento = 1;
                data_param.IdDependencia = 0;
                data_param.Estado = 1;
                data_param.IdEmpleado = 0
                data_param.NroDocumento = $("#txtNumeroDocumentoTrabajadorJudicial").val();

                $.ajax({
                    url: controladorApp.obtenerRutaBase() + 'Empleado/ListarEmpleados',
                    type: 'GET',
                    dataType: 'json',
                    contentType: 'application/json; charset=utf-8',
                    processData: true,
                    cache: false,
                    data: data_param,
                    success: function (res) {
                        if (res != null && res.length > 0) {
                            var vEmpleado = res[0].Paterno + ' ' + res[0].Materno + ' ' + res[0].Nombre;
                            $("#hdIdTrabajadorJudicial").val(res[0].IdEmpleado);
                            $("#txtNombreTrabajadorJudicial").val(vEmpleado);
                        }
                        else {
                            debugger;
                            // LimpiarModalRegistroPersona();
                            $("#hdIdTrabajadorJudicial").val('');
                            $("#txtNombreTrabajadorJudicial").val('');
                            controladorApp.notificarMensajeDeAlerta('No existe el número de documento, consultar con el administrador');
                        }
                    },
                    error: function (res) {
                        debugger;
                    }
                });

            }

            else {
                controladorApp.notificarMensajeDeAlerta("Ingrese un número de documento válido");
                return false;
            }

        }

        function BuscarBeneficiario() {
            var tipo = "Solic";
            var TIPO_DOC_DNI = '01';
            var TIPO_DOC_CE = '02';
            var campo = document.getElementById("txtNumeroDocumentoBeneficiario");
            var tipoDoc = "01";

            //var tipoDoc = $("#ddlPersonaTipoDeDocumento").data("kendoDropDownList").value();

            var urlBuscarPersona = URL + 'Persona/Buscar';
            debugger;

            if (campo.value.trim().length < 8) {
                controladorApp.notificarMensajeDeAlerta("Ingrese un número de documento válido");
                return false;
            }

            //if (tipoDoc == '') {
            //    controladorApp.notificarMensajeDeAlerta("Seleccione el tipo de documento");
            //    return false;
            //}

            if (campo.value.trim().length == 8) {
                // PRIMERO BUSCAMOS SI EL SOLICITANTE EXISTE EN NUESTRA BD
                var data_param = {};
                data_param.IdDependencia = 0;
                data_param.Estado = 1;
                data_param.IdEmpleado = 0
                data_param.NroDocumento = $("#txtNumeroDocumentoBeneficiario").val();

                debugger;

                //DescuentoJudicial
                if (campo.value.trim().length == 8 && tipoDoc == TIPO_DOC_DNI) {
                    // BUSCAMOS EN LA PIDE
                    return "" == campo
                    
                    ? (alert("Ingrese el número de documento"), !1)
                    : $.getJSON(urlBuscarPersona, {
                        'vNumDocum': campo.value.trim(),
                        'tipoDoc': tipoDoc
                    }).done(function (data) {

                        debugger;

                        if (data.IdPersona == -1) {
                            controladorApp.abrirMensajeDeConfirmacion(
                            data.Nombres + "\n\r¿Desea registrar manualmente el benficiario?", 'SI', 'NO'
                            , function (arg) {
                                //$("#txtNombreBeneficiario").removeAttr("readonly");
                                $("#txtNombreBeneficiario").val("");
                            }, null);
                        }
                        else
                        {
                            //alert(data.Nombres);
                            if (data.Nombres == null) {
                                controladorApp.abrirMensajeDeConfirmacion(
                                "No existe el número de documento ingresado" + "\n\r¿Desea registrar manualmente el beneficiario ?", 'SI', 'NO'
                                , function (arg) {
                                    //$("#txtNombreBeneficiario").removeAttr("readonly");
                                    $("#txtNombreBeneficiario").val("");
                             
                                }, null);
                            }
                            else {
                               // $("#txtNombreBeneficiario").attr("readonly", "readonly");
                                var nomBeneficiario = data.ApellidoPaterno + " " + data.Nombres + " " + data.ApellidoMaterno;
                                $("#txtNombreBeneficiario").val(nomBeneficiario);
                            }
                        }

                })

                .fail(function (jqxhr, textStatus, error) {
                    var err = textStatus + ", " + error;
                    controladorApp.notificarMensajeDeAlerta('No se pudo conectar al servidor');
                    console.log("Request Failed: " + err);
                });
                }

            }


        }

        function BuscarBeneficiarioJudicial() {
            var tipo = "Solic";
            var TIPO_DOC_DNI = '01';
            var TIPO_DOC_CE = '02';
            var campo = document.getElementById("txtNumeroDocumentoBeneficiarioJudicial");
            var tipoDoc = "01";

            //var tipoDoc = $("#ddlPersonaTipoDeDocumento").data("kendoDropDownList").value();

            var urlBuscarPersona = URL + 'Persona/Buscar';
            debugger;

            if (campo.value.trim().length < 8) {
                controladorApp.notificarMensajeDeAlerta("Ingrese un número de documento válido");
                return false;
            }

            //if (tipoDoc == '') {
            //    controladorApp.notificarMensajeDeAlerta("Seleccione el tipo de documento");
            //    return false;
            //}

            if (campo.value.trim().length == 8) {
                // PRIMERO BUSCAMOS SI EL SOLICITANTE EXISTE EN NUESTRA BD
                var data_param = {};
                data_param.IdDependencia = 0;
                data_param.Estado = 1;
                data_param.IdEmpleado = 0
                data_param.NroDocumento = $("#txtNumeroDocumentoBeneficiarioJudicial").val();

                debugger;

                //DescuentoJudicial
                if (campo.value.trim().length == 8 && tipoDoc == TIPO_DOC_DNI) {
                    // BUSCAMOS EN LA PIDE
                    return "" == campo

                    ? (alert("Ingrese el número de documento"), !1)
                    : $.getJSON(urlBuscarPersona, {
                        'vNumDocum': campo.value.trim(),
                        'tipoDoc': tipoDoc
                    }).done(function (data) {

                        debugger;

                        if (data.IdPersona == -1) {
                            controladorApp.abrirMensajeDeConfirmacion(
                            data.Nombres + "\n\r¿Desea registrar manualmente el benficiario?", 'SI', 'NO'
                            , function (arg) {
                                //$("#txtNombreBeneficiario").removeAttr("readonly");
                                $("#txtNombreBeneficiarioJudicial").val("");
                            }, null);
                        }
                        else {
                            //alert(data.Nombres);
                            if (data.Nombres == null) {
                                controladorApp.abrirMensajeDeConfirmacion(
                                "No existe el número de documento ingresado" + "\n\r¿Desea registrar manualmente el beneficiario ?", 'SI', 'NO'
                                , function (arg) {
                                    //$("#txtNombreBeneficiario").removeAttr("readonly");
                                    $("#txtNombreBeneficiarioJudicial").val("");

                                }, null);
                            }
                            else {
                                // $("#txtNombreBeneficiario").attr("readonly", "readonly");
                                var nomBeneficiario = data.ApellidoPaterno + " " + data.Nombres + " " + data.ApellidoMaterno;
                                $("#txtNombreBeneficiarioJudicial").val(nomBeneficiario);
                            }
                        }

                    })

                .fail(function (jqxhr, textStatus, error) {
                    var err = textStatus + ", " + error;
                    controladorApp.notificarMensajeDeAlerta('No se pudo conectar al servidor');
                    console.log("Request Failed: " + err);
                });
                }

            }


        }

    </script>
}

